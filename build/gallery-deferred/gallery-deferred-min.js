YUI.add("gallery-deferred",function(g){var f=g.Lang,e=g.Array,d=Array.prototype;function b(i){this._config=i||{};var j=this._et=new g.EventTarget();var h={emitFacade:false,fireOnce:true,preventable:false};j.publish("success",h);j.publish("failure",h);j.publish("complete",h);}g.mix(b.prototype,{_on:function(){return this._et.on.apply(this._et,arguments);},_fire:function(){this._et.fire.apply(this._et,arguments);return this;},then:function(i,h){var j=this;e.each(b._flatten(i),function(k){j._on("success",k);});e.each(b._flatten(h),function(k){j._on("failure",k);});return this;},done:function(){return this.then(g.Array(arguments));},fail:function(){return this.then(null,g.Array(arguments));},always:function(){var h=this;e.each(g.Array(arguments),function(i){h._on("complete",i);});return this;},resolve:function(){var h=g.Array(arguments);this._fire.apply(this,["success"].concat(h));return this._fire.apply(this,["complete"].concat(h));},reject:function(){var h=g.Array(arguments);this._fire.apply(this,["failure"].concat(h));return this._fire.apply(this,["complete"].concat(h));},defer:function(j,h){var i=new this.constructor(this._config);this.then(g.bind(j,h||this,i));return i;}});g.mix(b,{_flatten:function(h){var j=0;h=e(h).concat();while(j<h.length){if(g.Lang.isArray(h[j])){Array.prototype.splice.apply(h,[j,1].concat(h[j]));}else{j++;}}return h;}});g.Deferred=b;g.defer=function(i,h){var j=new g.Deferred();i(j);return j;};g.when=function(){var j=g.Deferred._flatten(arguments),i=[],h=0,k=0;return g.defer(function(o){function n(p){i.push(e(p));if(h+k===j.length){if(k>0){o.reject.apply(o,i);}else{o.resolve.apply(o,i);}}}function m(){h++;n(arguments);}function l(){k++;n(arguments);}e.each(j,function(p){if(g.Lang.isFunction(p)){m(p());}else{p.then(m,l);}});});};function c(){c.superclass.constructor.apply(this,arguments);var i=this._et;var h={emitFacade:true};i.publish("success",h);i.publish("failure",h);i.publish("complete",h);}g.extend(c,g.Deferred,null,{NAME:"io-request"});if(g.io){g.mix(g.io,{Request:c,_normalizeConfig:function(i,h){if(g.Lang.isFunction(i)){i={on:{complete:i}};}else{i=i||{};i.on=i.on||{};}return g.mix(i,h,true);},_defer:function(j,h){h=g.io._normalizeConfig(h);var i=new g.io.Request();function k(l){return function(o,m){var n={responseXML:m.responseXML,responseText:m.responseText};i._fire(l,n);};}if(h.on){i._on(h.on);}h.on={success:function(o,l){var m={responseXML:l.responseXML,responseText:l.responseText};if(h.parser){try{m.data=h.parser(l.responseText);}catch(n){i._fire("failure",l);return;}}i._fire("success",m);},failure:k("failure"),complete:k("complete")};return g.mix(i,g.io(j,h));},addMethod:function(h,i){g.io[h]=i;c.prototype[h]=function(){return g.io[h].apply(g.io,arguments);};},addMethods:function(h){g.Object.each(h,function(j,i){g.io.addMethod(i,j);});}});g.io.addMethods({get:function(i,h){return g.io._defer(i,g.io._normalizeConfig(h,{method:"GET"}));},post:function(i,j,h){return g.io._defer(i,g.io._normalizeConfig(h,{method:"POST",data:j}));},postForm:function(i,j,h){return g.io._defer(i,g.io._normalizeConfig(h,{method:"POST",form:{id:j}}));}});if(g.JSON){g.io.addMethod("getJSON",function(i,h){h=g.io._normalizeConfig(h);h.parser=g.JSON.parse;return g.io._defer(i,h);});}if(g.jsonp){g.io.addMethod("jsonp",function(j,h){h=g.io._normalizeConfig(h);var i=new g.io.Request();if(h.on){i._on(h.on);}h.on={};g.Array.each(["success","failure","complete"],function(k){h.on[k]=function(l){i._fire(k,{data:l});};});g.jsonp(j,h);return i;});}}function a(h){a.superclass.constructor.apply(this,arguments);this.host=h.host;}if(g.Node&&g.Plugin){g.extend(a,g.Deferred,null,{NS:"deferred",importMethod:function(h){a.prototype[h]=function(){if(this.host.deferred===this){this.resolve();}if(this.host[h]){var i=g.Array(arguments),j;if(g.Lang.isFunction(i[i.length-1])){j=i.pop();}return this.defer(function(k){this.host[h].apply(this.host,i.concat([g.bind(k.resolve,k)]));}).done(j);}else{if(g.instanceOf(this.host,g.NodeList)&&h=="load"){g.error("NodeList doesn't have a "+h+"() method");}else{g.error("Missing required module for "+h);}}return this;};}});g.Array.each(["hide","load","show","transition","once","onceAfter"],a.importMethod);g.Node.Deferred=a;}},"@VERSION@",{optional:["node","plugin","node-load","transition","io-base","json","jsonp"],requires:["event-custom"]});