YUI.add("gallery-deferred",function(g){var f=g.Lang,e=g.Array,d=Array.prototype;function b(i){b.superclass.constructor.apply(this,arguments);this._config=i||{};var h={emitFacade:false,fireOnce:true,preventable:false};this.publish("success",h);this.publish("failure",h);this.publish("complete",h);}g.extend(b,g.EventTarget,{then:function(i,h){var j=this;e.each(b._flatten(i),function(k){j.on("success",k);});e.each(b._flatten(h),function(k){j.on("failure",k);});return this;},done:function(){return this.then(g.Array(arguments));},fail:function(){return this.then(null,g.Array(arguments));},always:function(){var h=this;e.each(g.Array(arguments),function(i){h.on("complete",i);});return this;},resolve:function(){return this.fire.apply(this,["success"].concat(g.Array(arguments)));},reject:function(){return this.fire.apply(this,["failure"].concat(g.Array(arguments)));},defer:function(j,h){var i=new this.constructor(this._config);this.then(g.bind(j,h||this,i));return i;}},{_flatten:function(h){return e.reduce(e(h),function(j,i){return e(j).concat(e(i));});}});g.Deferred=b;g.defer=function(i,h){var j=new g.Deferred();i(j);return j;};g.when=function(){var j=g.Deferred._flatten(arguments),i=[],h=0,k=0;return g.defer(function(o){function n(p){i.push(e(p));if(h+k===j.length){if(k>0){o.reject.apply(o,i);}else{o.resolve.apply(o,i);}}}function m(){h++;n(arguments);}function l(){k++;n(arguments);}e.each(j,function(p){if(g.Lang.isFunction(p)){m(p());}else{p.then(m,l);}});});};function c(){c.superclass.constructor.apply(this,arguments);var h={emitFacade:true};this.publish("success",h);this.publish("failure",h);this.publish("complete",h);}g.extend(c,g.Deferred,null,{NAME:"io-request"});g.mix(g.io,{Request:c,_normalizeConfig:function(i,h){if(g.Lang.isFunction(i)){i={on:{complete:i}};}else{i=i||{};i.on=i.on||{};}return g.mix(i,h,true);},_defer:function(i,h){h=g.io._normalizeConfig(h);var j=new g.io.Request();if(h.on){j.on(h.on);}h.on={success:function(n,k){var l={responseXML:k.responseXML,responseText:k.responseText};if(h.parser){try{l.data=h.parser(k.responseText);}catch(m){j.fire("failure",k);return;}}j.fire("success",l);j.fire("complete",l);},failure:function(m,k){var l={responseXML:k.responseXML,responseText:k.responseText};j.fire("failure",l);j.fire("complete",l);}};return g.mix(j,g.io(i,h));},addMethod:function(h,i){g.io[h]=i;c.prototype[h]=function(){return g.io[h].apply(g.io,arguments);};},addMethods:function(h){g.Object.each(h,function(j,i){g.io.addMethod(i,j);});}});g.io.addMethods({get:function(i,h){return g.io._defer(i,g.io._normalizeConfig(h,{method:"GET"}));},post:function(i,j,h){return g.io._defer(i,g.io._normalizeConfig(h,{method:"POST",data:j}));},postForm:function(i,j,h){return g.io._defer(i,g.io._normalizeConfig(h,{method:"POST",form:{id:j}}));}});if(g.JSON){g.io.addMethod("getJSON",function(i,h){h=g.io._normalizeConfig(h);h.parser=g.JSON.parse;return g.io._defer(i,h);});}if(g.jsonp){g.io.addMethod("jsonp",function(j,h){h=g.io._normalizeConfig(h);var i=new g.io.Request();if(h.on){i.on(h.on);}h.on={};g.Array.each(["success","failure","complete"],function(k){h.on[k]=function(l){i.fire(k,{data:l});};});g.jsonp(j,h);return i;});}function a(h){a.superclass.constructor.apply(this,arguments);this.host=h.host;}if(g.Node&&g.Plugin){g.extend(a,g.Deferred,null,{NS:"deferred",importMethod:function(h){a.prototype[h]=function(){if(this.host.deferred===this){this.resolve();}if(this.host[h]){var i=g.Array(arguments),j;if(g.Lang.isFunction(i[i.length-1])){j=i.pop();}return this.defer(function(k){this.host[h].apply(this.host,i.concat([g.bind(k.resolve,k)]));}).done(j);}else{if(g.instanceOf(this.host,g.NodeList)&&h=="load"){g.error("NodeList doesn't have a "+h+"() method");}else{g.error("Missing required module for "+h);}}return this;};}});g.Array.each(["hide","load","show","transition"],a.importMethod);g.Node.Deferred=a;}},"@VERSION@",{optional:["node","plugin","node-load","transition","json","jsonp"],requires:["event-custom","io-base","array-extras"]});