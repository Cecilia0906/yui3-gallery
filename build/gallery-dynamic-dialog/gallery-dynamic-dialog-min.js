YUI.add("gallery-dynamic-dialog",function(h){var e,d=h.Panel,c=h.Lang,b=c.sub,g=c.isValue,a=c.isString,f=h.Object.each;e=h.Base.create("dynamicDialog",h.Base,[],{IO_FAILURE_CLASS:"yui3-dynamic-dialog-io-failure",BUTTONS:{OK:"Ok",CANCEL:"Cancel",SUBMIT:"Submit"},container:h.one(document.body),panels:{},DEFAULT_EVENTS:{"a.open-dialog":"click","a.remote-dialog":"click"},initializer:function(){this.publish("submit",{defaultFn:this._defSubmitFn,preventable:true});},setupDelegates:function(){var i=this.container,j=this.DEFAULT_EVENTS,k=h.bind(this._triggerEventFn,this);f(j,function(m,l){i.delegate(m,k,l);});},_triggerEventFn:function(m){var n=m.currentTarget,i=n.get("tagName")==="A"?n.get("href"):n.get("target"),q={},j=i.substr(i.indexOf("#")),p=h.one(j),k=this.panels[j],l=n.get("attributes"),o=[];l.each(function(s){var r=s.get("name");if(r.match(/^data-/)){var t=n.getAttribute(r);if(t!==null){q[r.substr(5)]=t;}}});if(k||p){m.preventDefault();if(!k){k=this._setupDialog(n,p,q);}else{if(p){k.setStdModContent(h.WidgetStdMod.BODY,b(p.getContent(),q));}}k.trigger=n;k.show();}},_setupDialog:function(m,s,t){var u=this,q=m.getAttribute("title")||s.getAttribute("title")||"",n=b(s.getContent(),t),r=m.getAttribute("data-modal")||s.getAttribute("data-modal")||this.get("modal"),i=null,p=this.BUTTONS,l=s.getAttribute("data-async")==="true",k=h.bind(this._defSubmitButtonFn,this),o=null,j=null;i=new d({headerContent:q,bodyContent:n,modal:r,centered:true});i.render(this.container);i.get("boundingBox").addClass("yui3-dynamic-dialog");o=i.get("contentBox");j=o.one("form");if(j){i.addButton({value:p.CANCEL,classNames:["yui3-dynamic-dialog-cancel"],action:function(v){v.preventDefault();this.hide();},section:h.WidgetStdMod.FOOTER});i.addButton({value:p.SUBMIT,classNames:["yui3-dynamic-dialog-submit"],action:function(v){v.preventDefault();v.async=l;v.dialog=this;v.trigger=this.trigger;v.form=this.get("contentBox").one("form");if(!v.form){throw"Form disappeared, was the dialog content replaced incorrectly?";}k(v);},section:h.WidgetStdMod.FOOTER});}else{i.addButton({value:p.OK,classNames:["yui3-dynamic-dialog-ok"],action:function(v){v.preventDefault();this.hide();},section:h.WidgetStdMod.FOOTER});}this.panels["#"+s.get("id")]=i;return i;},_defSubmitButtonFn:function(i){this.fire("submit",{dialog:i.dialog,trigger:i.trigger,form:i.form,async:i.async||false});},_defSubmitFn:function(o){var k=o.dialog,m=o.form,l=o.async,j=o.trigger||k.trigger,n=m.getAttribute("action"),p=m.getAttribute("method")||"POST",i={};if(!l){k.hide();return;}i.method=p.toUpperCase();i.form={id:m};i.context=this;i.arguments={dialog:k,form:m,trigger:j};i.on={success:this._ioSuccess,failure:this._ioFailure};h.io(n,i);},_ioSuccess:function(k,j,i){i.dialog.hide();i.response=j;this.fire("ioSuccess",i);},_ioFailure:function(p,m,i){var j=i.dialog,l=i.form,n=j.get("boundingBox"),k=this.IO_FAILURE_CLASS;i.response=m;this.fire("ioFailure",i);n.addClass(k);this._shakeNode(n,h.bind(function(){this.removeClass(k);},n));if(m.responseText){j.setStdModContent(h.WidgetStdMod.BODY,m.responseText);}},_shakeNode:function(l,n){var k=l.getX(),j=l.getY(),i=k+5,m;l.get("clientX");m=new h.Anim({node:l,to:{xy:[i,j]},duration:0.01,iterations:10,direction:"alternate"});if(n&&typeof n==="function"){m.on("end",n);}m.run();return m;}},{ATTRS:{modal:{value:false}}});h.DynamicDialog=e;},"@VERSION@",{requires:["anim","substitute","widget","base","panel","io","io-form","event-delegate"]});