<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Example: Using the crop event</title>
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Maven+Pro:400,700">
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.4.1/build/cssgrids/grids-min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <script src="http://yui.yahooapis.com/3.6.0/build/yui/yui-min.js"></script>
    
</head>
<body>

<div id="doc">
    <h1>Example: Using the crop event</h1>

    

    <div class="yui3-g">
        <div class="yui3-u-3-4">
            <div id="main">
                <div class="content"><script>
YUI_config = {
  filter: 'raw',
  modules: {
    'gallery-imagecropper-styles': {
      type: 'css',
      fullpath: '/src/gallery-imagecropper/build_tmp/assets/skins/sam/gallery-imagecropper.css'
    },
    'gallery-imagecropper': {
      fullpath: '/src/gallery-imagecropper/build_tmp/gallery-imagecropper.js',
      requires: ['widget', 'dd-drag', 'dd-constrain', 'resize-base', 'resize-constrain', 'gallery-imagecropper-styles']
    }
  }
};
</script>
<style>
.example {
  position: relative;
}
#preview {
  position: absolute;
  left: 400px;
  top: 15px;
}
</style>

<div class="intro">
<p>
This example demonstrates how to use the <code>crop:crop</code> event from ImageCropper to update a preview of the cropped image. Try moving around the crop rectangle and see how it's reflected on the preview.
</p>
</div>

<div class="example yui3-skin-sam">
    <div class="yui3-skin-sam">
  <div id="imagecropper"></div>
  <div id="preview">
    <div id="result"></div>
    <p id="coords"></p>
  </div>
</div>

<script type="text/javascript">
YUI().use('gallery-imagecropper', function(Y) {
    
  Y.Node.addMethod('setBackgroundXY', function (node, xy) {
    xy = xy || [0, 0];
    Y.Array.each(xy, function (val, i) {
      if (Y.Lang.isNumber(val)) {
        xy[i] += 'px';
      }
    });
    this.setStyles({
      backgroundPosition: xy.join(' '),
      backgroundPositionX: xy[0],
      backgroundPositionY: xy[1]
    });
  });
  
  var imageSource = 'http://farm8.staticflickr.com/7016/6748720265_e2f3e82fee.jpg',
      coordview = Y.one('#coords'),
      result = Y.one('#result').setStyle('backgroundImage', 'url(' + imageSource + ')');

  function updatePreview(coords) {
    coordview.setContent(coords.left + 'x' + coords.top + ' ' + coords.width + 'x' + coords.height);

    result.setBackgroundXY([-coords.left, -coords.top]).setStyles({
      width: coords.width,
      height: coords.height
    });
  }
    
  var imagecropper = new Y.ImageCropper({
    source: imageSource,
    width: 333,
    height: 500
  });  
  imagecropper.render('#imagecropper');

  imagecropper.on('crop:crop', function (e) {
    updatePreview(e);
  });

  updatePreview(imagecropper.getCropCoords());
});
</script>

</div>

<h2>Using the crop event</h2>
<h3>The markup</h3>
<p>The <code>yui3-skin-sam</code> class will provide the default look and feel for the resize controls that ImageCropper uses.
<pre class="code prettyprint">&lt;div class=&quot;yui3-skin-sam&quot;&gt;
  &lt;!-- Here we&#x27;ll render the ImageCropper --&gt;
  &lt;div id=&quot;imagecropper&quot;&gt;&lt;&#x2F;div&gt;
  &lt;div id=&quot;preview&quot;&gt;
    &lt;!-- We&#x27;ll use this div to show set its background image with the resulting preview --&gt;
    &lt;div id=&quot;result&quot;&gt;&lt;&#x2F;div&gt;
    &lt;!-- We&#x27;ll insert here the coordinates returned by ImageCropper --&gt;
    &lt;p id=&quot;coords&quot;&gt;&lt;&#x2F;p&gt;
  &lt;&#x2F;div&gt;
&lt;&#x2F;div&gt;</pre>

<h3>Setting up the YUI instance</h3>
<p>The only module you need is the <code>imagecropper</code> module.</p>
<pre class="code prettyprint">&lt;script&gt;
YUI().use(&#x27;gallery-imagecropper&#x27;, function (Y) {
    &#x2F;&#x2F; We&#x27;ll write example code here
});
&lt;&#x2F;script&gt;</pre>

<h3>A Node method for setting the background position</h3>
<p>We'll need to set the background position of the <code>result</code> element according to the coordinates given by the widget, so we'll setup a Node helper method to do it.</p>
<pre class="code prettyprint">&#x2F;&#x2F; Declare a utility method on Node to set the background
&#x2F;&#x2F; position style
Y.Node.addMethod(&#x27;setBackgroundXY&#x27;, function (node, xy) {
  xy = xy || [0, 0];
  &#x2F;&#x2F; Default Number coordinates to pixels
  Y.Array.each(xy, function (val, i) {
    if (Y.Lang.isNumber(val)) {
      xy[i] += &#x27;px&#x27;;
    }
  });
  &#x2F;&#x2F; Some browsers support the backgroundPosition shorthand
  &#x2F;&#x2F; others require you to set both X and Y separately
  this.setStyles({
    backgroundPosition: xy.join(&#x27; &#x27;),
    backgroundPositionX: xy[0],
    backgroundPositionY: xy[1]
  });
});</pre>


<h3>Settig up the photo</h3>
<p>You can fetch the photo's information using the <code>IO</code> module or using any other method you prefer.</p>
<pre class="code prettyprint">&#x2F;&#x2F; This is the image we&#x27;ll use from Flickr
var imageSource = &#x27;http:&#x2F;&#x2F;farm8.staticflickr.com&#x2F;7016&#x2F;6748720265_e2f3e82fee.jpg&#x27;,
    coordview = Y.one(&#x27;#coords&#x27;),
    result = Y.one(&#x27;#result&#x27;).setStyle(&#x27;backgroundImage&#x27;, &#x27;url(&#x27; + imageSource + &#x27;)&#x27;);

function updatePreview(coords) {
  &#x2F;&#x2F; Show the new coordinates
  coordview.setContent(coords.left + &#x27;x&#x27; + coords.top + &#x27; &#x27; + coords.width + &#x27;x&#x27; + coords.height);

  &#x2F;&#x2F; When we move the crop rectangle to the right, we must move the 
  &#x2F;&#x2F; background to the left to reflect the shown area
  result.setBackgroundXY([-coords.left, -coords.top]).setStyles({
    width: coords.width,
    height: coords.height
  });
}</pre>

<h3>Instantiating the ImageCropper</h3>
<pre class="code prettyprint">&#x2F;&#x2F; Create an imagecropper
var imagecropper = new Y.ImageCropper({
  src: &#x27;http:&#x2F;&#x2F;farm8.staticflickr.com&#x2F;7016&#x2F;6748720265_e2f3e82fee.jpg&#x27;,
  width: 333,
  height: 500
});  
imagecropper.render(&#x27;#imagecropper&#x27;);</pre>

<h3>Listening to the <code>crop</code> event and showing the initial state</h3>
<p></p>
<pre class="code prettyprint">&#x2F;&#x2F; Listen to the crop event to update the result preview
imagecropper.on(&#x27;crop:crop&#x27;, function (e) {
  &#x2F;&#x2F; The event facade contains the same properties as the object that
  &#x2F;&#x2F; getCropCoords() returns: left, top, width, height
  &#x2F;&#x2F; We use them to update the preview
  updatePreview(e);
});

&#x2F;&#x2F; Show the initial coordinates
updatePreview(imagecropper.getCropCoords());</pre>


<h2>Complete Example Source</h2>

<pre class="code prettyprint">&lt;div class=&quot;yui3-skin-sam&quot;&gt;
  &lt;div id=&quot;imagecropper&quot;&gt;&lt;&#x2F;div&gt;
  &lt;div id=&quot;preview&quot;&gt;
    &lt;div id=&quot;result&quot;&gt;&lt;&#x2F;div&gt;
    &lt;p id=&quot;coords&quot;&gt;&lt;&#x2F;p&gt;
  &lt;&#x2F;div&gt;
&lt;&#x2F;div&gt;

&lt;script type=&quot;text&#x2F;javascript&quot;&gt;
YUI().use(&#x27;gallery-imagecropper&#x27;, function(Y) {
    
  Y.Node.addMethod(&#x27;setBackgroundXY&#x27;, function (node, xy) {
    xy = xy || [0, 0];
    Y.Array.each(xy, function (val, i) {
      if (Y.Lang.isNumber(val)) {
        xy[i] += &#x27;px&#x27;;
      }
    });
    this.setStyles({
      backgroundPosition: xy.join(&#x27; &#x27;),
      backgroundPositionX: xy[0],
      backgroundPositionY: xy[1]
    });
  });
  
  var imageSource = &#x27;http:&#x2F;&#x2F;farm8.staticflickr.com&#x2F;7016&#x2F;6748720265_e2f3e82fee.jpg&#x27;,
      coordview = Y.one(&#x27;#coords&#x27;),
      result = Y.one(&#x27;#result&#x27;).setStyle(&#x27;backgroundImage&#x27;, &#x27;url(&#x27; + imageSource + &#x27;)&#x27;);

  function updatePreview(coords) {
    coordview.setContent(coords.left + &#x27;x&#x27; + coords.top + &#x27; &#x27; + coords.width + &#x27;x&#x27; + coords.height);

    result.setBackgroundXY([-coords.left, -coords.top]).setStyles({
      width: coords.width,
      height: coords.height
    });
  }
    
  var imagecropper = new Y.ImageCropper({
    source: imageSource,
    width: 333,
    height: 500
  });  
  imagecropper.render(&#x27;#imagecropper&#x27;);

  imagecropper.on(&#x27;crop:crop&#x27;, function (e) {
    updatePreview(e);
  });

  updatePreview(imagecropper.getCropCoords());
});
&lt;&#x2F;script&gt;</pre>

</div>
            </div>
        </div>

        <div class="yui3-u-1-4">
            <div class="sidebar">
                

                
                    <div class="sidebox">
                        <div class="hd">
                            <h2 class="no-toc">Examples</h2>
                        </div>

                        <div class="bd">
                            <ul class="examples">
                                
                                    
                                        <li data-description="This example shows how to create an ImageCropper from markup">
                                            <a href="imagecropper-basic.html">Augmenting an image with an ImageCropper</a>
                                        </li>
                                    
                                
                                    
                                        <li data-description="This example shows how to use ImageCropper events to show a preview of the image being cropped">
                                            <a href="imagecropper-events.html">Using the crop event</a>
                                        </li>
                                    
                                
                                    
                                        <li data-description="This example shows how to select the image to crop from a list of thumbnails">
                                            <a href="imagecropper-gallery.html">Cropping images from thumbnails</a>
                                        </li>
                                    
                                
                                    
                                        <li data-description="This example shows how to develop a Plugin for ImageCropper that resizes the widget automatically based on the size of its image">
                                            <a href="imagecropper-autosize.html">Writing an ImageCropper AutoSize plugin</a>
                                        </li>
                                    
                                
                            </ul>
                        </div>
                    </div>
                

                
            </div>
        </div>
    </div>
</div>

<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>


</body>
</html>
